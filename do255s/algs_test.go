package do255s

import (
	"bytes"
	"crypto"
	"encoding/hex"
	"golang.org/x/crypto/sha3"
	"testing"
)

func TestDo255sKeyGen(t *testing.T) {
	for i := 0; (2 * i) < len(kat_DO255S_KEYGEN); i++ {
		rsk, _ := hex.DecodeString(kat_DO255S_KEYGEN[2*i])
		rpk, _ := hex.DecodeString(kat_DO255S_KEYGEN[2*i+1])
		sh := sha3.NewShake256()
		var bb [1]byte
		bb[0] = byte(i)
		sh.Write(bb[:])
		sk, _ := Do255sGenerateKeyPair(sh)
		esk := sk.Encode(nil)
		epk := sk.Public().Encode(nil)
		if !bytes.Equal(esk, rsk) {
			t.Fatalf("Wrong private key generated:\nexp = %s\ngot = %s\n", hex.EncodeToString(rsk), hex.EncodeToString(esk))
		}
		if !bytes.Equal(epk, rpk) {
			t.Fatalf("Wrong public key generated:\nexp = %s\ngot = %s\n", hex.EncodeToString(rpk), hex.EncodeToString(epk))
		}
	}
}

func TestDo255sECDH(t *testing.T) {
	for i := 0; i < len(kat_DO255S_ECDH); i += 5 {
		rsk, _ := hex.DecodeString(kat_DO255S_ECDH[i])
		rppk1, _ := hex.DecodeString(kat_DO255S_ECDH[i+1])
		rsec1, _ := hex.DecodeString(kat_DO255S_ECDH[i+2])
		rppk2, _ := hex.DecodeString(kat_DO255S_ECDH[i+3])
		rsec2, _ := hex.DecodeString(kat_DO255S_ECDH[i+4])

		sk, _ := Do255sDecodePrivateKey(rsk)

		sec, ok := Do255sKeyExchange(sk, rppk1, len(rsec1))
		if ok != 1 {
			t.Fatalf("Test %d: ECDH failed\n", i)
		}
		if !bytes.Equal(sec, rsec1) {
			t.Fatalf("Test %d: wrong secret:\nexp = %s\ngot = %s\n", i, hex.EncodeToString(rsec1), hex.EncodeToString(sec))
		}

		sec, ok = Do255sKeyExchange(sk, rppk2, len(rsec2))
		if ok != 0 {
			t.Fatalf("Test %d: ECDH should have failed\n", i)
		}
		if !bytes.Equal(sec, rsec2) {
			t.Fatalf("Test %d: wrong secret:\nexp = %s\ngot = %s\n", i, hex.EncodeToString(rsec2), hex.EncodeToString(sec))
		}
	}
}

func TestDo255sSign(t *testing.T) {
	for i := 0; i < len(kat_DO255S_SIGN); i += 5 {
		rsk, _ := hex.DecodeString(kat_DO255S_SIGN[i])
		rpk, _ := hex.DecodeString(kat_DO255S_SIGN[i+1])
		seed, _ := hex.DecodeString(kat_DO255S_SIGN[i+2])
		data, _ := hex.DecodeString(kat_DO255S_SIGN[i+3])
		rsig, _ := hex.DecodeString(kat_DO255S_SIGN[i+4])

		sk, _ := Do255sDecodePrivateKey(rsk)
		pk := sk.Public()
		epub := pk.Encode(nil)
		if !bytes.Equal(epub, rpk) {
			t.Fatalf("Test %d: wrong public key:\nexp = %s\ngot = %s\n", i, hex.EncodeToString(rpk), hex.EncodeToString(epub))
		}
		sig, err := sk.signWithSeed(seed, data, crypto.Hash(crypto.SHA3_256))
		if err != nil {
			t.Fatal(err)
		}
		if !bytes.Equal(sig, rsig) {
			t.Fatalf("Test %d: wrong signature:\nexp = %s\ngot = %s\n", i, hex.EncodeToString(rsig), hex.EncodeToString(sig))
		}
		if !pk.VerifyVartime(data, crypto.Hash(crypto.SHA3_256), sig) {
			t.Fatalf("Test %d: signature was not verified\n", i)
		}
		data[0] ^= byte(0x01)
		if pk.VerifyVartime(data, crypto.Hash(crypto.SHA3_256), sig) {
			t.Fatalf("Test %d: signature should not have been accepted\n", i)
		}
	}
}

func TestDo255sHashToCurve(t *testing.T) {
	var src [100]byte
	for i := 0; i < len(src); i++ {
		src[i] = byte(i)
	}
	for i := 0; i < len(kat_DO255S_HASHTOCURVE); i++ {
		rp, _ := hex.DecodeString(kat_DO255S_HASHTOCURVE[i])

		P, err := Do255sHashToCurve(src[:i], crypto.Hash(0))
		if err != nil {
			t.Fatal(err)
		}
		ep := P.Encode(nil)
		if !bytes.Equal(ep, rp) {
			t.Fatalf("Test %d: wrong output:\nexp = %s\ngot = %s\n", i, hex.EncodeToString(rp), hex.EncodeToString(ep))
		}
	}
}

// Keygen tests.
// For i in 0..19, keygen with SHAKE256((byte)i) as source.
// Each group of two values is the private/public key pair.
var kat_DO255S_KEYGEN = []string{
	"f17dbcbef04a157b7e470b6563940017e5de0bbf30042ef0a86e36f4b8600d14",
	"07e4009d918a6c56f5a65896a8720ae26d4beeefcf67acd236886ca5475a1219",

	"0635a00de8e704b122b478bd1a0663a777153d5b748baf796190856803d9773a",
	"a6b4f6eff4a248044f7421d32c85ec7dec6677afc90df497beadd489f104f729",

	"c22008517d59517518530122a42f14099a9b5b7d7cb4adb2ca59716b5eacf811",
	"26b85f600b2f03b027024bb5156f16c6a39f72eb34c9133c3b50c14050218979",

	"db4252337900d8ab7f609d170135d459a6798945d5a574d4a9db7b623c754d07",
	"dc450fc99fe87dbec0f5f31edb85eb133ec9cbe6598481a09d2fb9bd92f48057",

	"87f1eb67b2f70780ff554843c8bd2980540cf15ed1d23499d013359759ef5927",
	"41492f6a1150193c44abae47ed6b164e27d808c10ac6d98c3d3ac6d87b7ca607",

	"fda04889dca632c34e1fb3d9939057ff557816bd83143f2397703f794ba3e130",
	"ef070d9bbff46988e6899511ebe3b532afb8caab3aa7a3bfe7280c23764a2559",

	"bea6f1eb5e8e3d50f605bb614f706d1e0826071c3f4223cc321ba4cd0aec6502",
	"0211f9839282ba0d86761aafb129e2c76da9312c492210aa96fe7d841b302c3e",

	"6312bea16eac7bdf93d5d2299aa8c9a248aa2571ae69543fa6a7a837532d0632",
	"8680740b543c20ce1dd3d2bc4950258cdad26b53a904fe531397e5e25e5aaf53",

	"c0391dac03aa88c968c365a0742643cab88ca34a127e1c9f5d71d9ecb3afd423",
	"e12f617a9656751a45db6f00746e90eb56e7b31933bf1afd3a4fa554ab31695f",

	"4266dfe30012338515c44c70764d7aac247f97e4f7913713a80cb2630b646935",
	"665bc6df189d53fc4d59d3b5e8cf45349ab7ae15f1ad1b0aa2705feef4741129",

	"7e01e5d06f93257b18e60da64307ad3457a5b711d99cda07ff14042c4d8b833a",
	"2e608d5fe618f81088d25e06d561f89ca90679c27673053d334a53dfee00817d",

	"6150b3748ba9bac015d100718850b5530073659eededed0b7e6f6ebb886d392d",
	"924e4fef4a4c467a01c0631ad3f3b2127e48ac4102eb806af3dee20b0ef2fd17",

	"a597ac8b40b108940feb5c6325590931981e40b1c4d1d69210f9f802e85fda1f",
	"27fceec7ac050d8353143392e2d63c38203fa1233af5ec37e8296639e0ba6770",

	"9fa0822c27259906d052b2f8ba7ef8a318d92cff32063a1d3985f140fa2cfb2f",
	"a23666c90f966c199ab0727a274abf39f4921d2f5df2d264da73a80856f4ef33",

	"66c8576f3896a194f48c91f71e8c999ba77e77a291188897de766170d6131503",
	"4675d07601fabed44c2835dd417efa263655c6fd0aca3fdfdf2dfc316240ef07",

	"aabb07488ff9edd05d6a603b7791b60a16d45093608f1badc0c9cc9a9154f215",
	"3ecbb71ee68ca84fbedd6167c48265aeee3df84dcf526b4042f52248649c0912",

	"a71570d4a4d7660efec3a4486cacfd2a3c83b327ef8d86caab540ef295edb33e",
	"05fbd65bf8cfc86403ef17f896c4396bb6aa3bcf9048c67330041a850ae7c119",

	"2b75a94787b9c8f3bc4d7f7192e3bd99940f0333bd845b66933d0bfabbec842f",
	"443294a320d54e81c54cd32d7f5b68eaee96331515887e19253cb897996c4260",

	"edbe8ff65bb6188a1890fa66add7caddcb2851ebab1dc1cf4bff878a13686133",
	"8f35d1a21a173ca61247229a6e16a98e77b37a4d52f7a0baa2e482ad3691b255",

	"fa928cb0835f556b83c794dbc0d22a30895070a9998371ad3bab311da54c9716",
	"a45d4fae9b1c3f0d553b2b181bd6f3f2362d59898b99b83fab2d0d5aa90d655d",
}

// ECDH tests.
// Each group of five values is:
//   private key
//   public peer point (valid)
//   secret from ECDH with valid peer point
//   public peer point (invalid)
//   secret from ECDH with invalid peer point
var kat_DO255S_ECDH = []string{
	"0b60d9af0d907ad367c24916a2a5a7304d91627c062995a4247952fb90a67e07",
	"d642ebc9d2c25d04dd4f5a2b2fec9bb113c4a5e7cf18f133012a9ecc0c34805d",
	"496dc32968fa89024ccbbfa52a0fee974e5046dfdc61ea8b4c818e73e3bddf25",
	"76c6b5d3de8130ff877421680d399121e3940cb0de15f32b85ed660beeca5b05",
	"af8aa84ca1a92b5a493c09e10d015915659d53ee17eacaf30bcc6eef031c3a5c",

	"8f95a611095c4ef62bbff5655ef9709ec282624bcfcef0c6c397d2017e8c682b",
	"a80f03420c7a1f97f53e3ee1f7b250510870b47c05697aec5d0c6a78e5f38651",
	"5976a88675c86548925f463d02ca025199bae4b2b8eb543e60ba613f43650fd9",
	"bdbedc86551dac2f4e5aedd8dedd23f737bfecafc4d3ccef98c12434486acd21",
	"4edbf4dceef3fab819d65e748a8bac665d9a92e25d85678fd882186a7c5531ae",

	"5c1ddcb969ceff6d08376f37620e8db26d547988a9711bc0ceb81aecb287510e",
	"9be0a372230295c530ac8f1068b51798bb71e09db69a29e9bc6f24aca87c7313",
	"7727be9d3e2a49a12218501dd2f15f8133460e870d322f6793a5b037febd96ea",
	"23d40935d51eea778bbe72645278f0a738f33aee6b089a7a94c3426c519b893a",
	"db0b45c097684f8bbae4515a0b58aa4e1e42a5f0d883fedb758f6efb68e6581f",

	"58eb59334187c7b1177b19734e412115d8a83b87744d6f1c646f002d2fd56d2a",
	"3a52a1735586f1ae3f7bc97c3e04d342b861755874e92191191b03ae20ae9a3f",
	"02f70f575c05cc8f195c62f5c9371609f116c50aeddcfa037af678c3b032d7d4",
	"15483dea69a547c3a6ddbcb81e3374145344e64e38918ff40b3e0e8df5f78f0f",
	"55a7c3a1146e07ae19fab223e3d909672ac24e6c7949beadf6ee96493a7a6206",

	"6d206c6ef982d5de8b6142bf3d4e7a95dcb4e3db20a0cfd8fba72a5afe956531",
	"dd6e99b75e6b83422ce683f5a4081de22926767d3e34c21f51b4b88925256663",
	"7762e2dd5b5aed06ee17675931cc9540e9a917489e1ba05c82ca691e493f1f23",
	"a8b7403e0618b033ef62139deea274bbb7c7d455de8646bffd9f4a1ab3e3ba11",
	"389814e5e5c1479a8d7e7db177ee5b50029ab90ffe51e9f0c98685934c09a844",

	"e9cdb07c36fe154b43433e593f6f96cb2bd4352f66d530fb54b6401cdcb1942f",
	"15fbedede4fe2a5b48d74ed6bb44fbe85efc7da2648064d5e6e8c1c436de866e",
	"9279a6f3c4a6fcfe2be8de9ae27b7f4ef315cd360cad44e4def29b2e69aba62c",
	"a888375439a860c2f5f4b5e21366d7b27afd47c8e3c02f4577aa459c3db6a455",
	"3b9f382ebfbc5734f082867ebbacadea5e80e611b53400fce10312d657a73a74",

	"4a90bd7b42af4bddd61339010b58a87887990fd63883fb30825d15442f84de09",
	"b3d3629f8ebb06c6495c5e43da2dda4d70411e9b4dd2c5d547c1f71f4aa39b45",
	"eadc84acb8c474582062c9e028e35b06a027e19850dfbd6e5361dc02abb5f7a6",
	"5d54defb01469867de1586693abca766725a7614c0efaf3abd3971a365ee062f",
	"044ca8c19987d9e6147e70d2da59a55be892dc23e57e9b494cb01d4ede14ece5",

	"bedf5af3c0cacde96ec1774eddc4572bbd598fa53b9d8e91710260d67a4f782e",
	"a53dca0723c4fd22e8bc2ea0667a79658dad95c32b64f09b5fb5013e4e07391a",
	"4f0453d61d07dac237b44b6847408fc9757a8e6475b37d3275fdfcf740b34169",
	"5316bafd1104ea456a817c1a6967f2e3ad50257aad97ce4323090ab4809a7827",
	"5a2965d2e6cb6540c56d2e9a9e18a7f8b1f4ae904ca26b65cb228137c7c9ec16",

	"2a6fbfc17da763851cec7006abaee6a5890077891912801d6e7654cf4da0353b",
	"a7ee66e44141aec2ba0b01801db5785b686de1a1a1254f8ebc3de3c2505c730c",
	"64636087be0e692c209f302430febc61447436ebbd1b3bd92a1e89e971a07cc8",
	"8747b9b81a5152a075dfd12d6ccdb987cff6d069dd528fb895e5abdb9ca67526",
	"6568ce09e4f0390b060a2c8735d4137da14d46b39740b1ad503419b3e74a16fc",

	"978fe1674bb4875a12de35acdd4fa5bc703154f401e120c9c93f6a65f9015c28",
	"974a59c33edcf045159d8a8bcc4ea0dc8fad2ac8db0d2a6ebebcac8e503b7276",
	"dcab715ecccaf190a1d4bbca320908883c143df8c45055f32f83057b109938dc",
	"0d3c17ce3c7b8cb19d73a868e66892572688abd9ecd7c19b725efd3aa0138216",
	"119bb167339e0202cc240650e4e456b607cc19c54ce449e9d27047da7bde779f",

	"c888bb347d7a05609ba08dec3245db1af77dee4d854e07c0da9e20cee358473a",
	"faa6f8374e37d0d431f25b2b5249cfbad8b472b6aa931eac85ee3ac005326832",
	"ee942c37d828c77ad8cbd89effa1993628d336aca02b981f9df05b6e087537c8",
	"0b3aa099e0bca5abc5bd6736dcf6de294406e8e86f0af1e76db469fced569e26",
	"64cab2da182bf86382f4016fc902f5f9f79afffe20a0849a3597b86dc8eb13c2",

	"20074bd97f8f2d40ac4e1811bbf3405be9bc900cd7ac662b64f48d97f324bd1e",
	"8c1f8896cc56dfda73317b21403ba1ee38a9823230565fbe5706cb9d23a87f5d",
	"db25cdcd75c919ee5d10d1e9420061ebf4ea4e83a6dda8531c7ad63532981d41",
	"540910e3bb076075da39700f6b72cdc6c611a315ff0402a1471218a18e46991d",
	"79a4c3b6f27046ab7d7495dab1f1ee95b9da22e4660a1bb8555a9c7da6a9d760",

	"71fe7be0cefac677f315e53d9bbb5a317ee024ae8c82ea904aa7d5496dcd3a11",
	"f68bd5940810a1c3c85b50ac2b656eab983f0507bccedae3329adfc4876a7565",
	"ccf688fc2d007e78bc9f34ffb928839d6c60f6184cfc2307100c891439f4cd57",
	"865f2cf34ea2ee326d42b62d7868b9a12dbcb2b26858c333ea978df37b5d2870",
	"a33f09bef70a295702bfbfd992cea1fc31038667c2accc8b3873fd72ac143255",

	"c179c485ff5cb0537268906d66f36a25fb11b551662b799d761a4a9097f2fc32",
	"68bef03de98f175a15121a01234c6084882008eebab1c6cf95576724faa8e27c",
	"5ce14f7915ba47a14377c1bed66c79b4640cd0a243aa3b1748dd756a8fb68b55",
	"31596598561f475e5379c15129b1c9f833c831a376e4b639bb57ed77f7faa126",
	"6bcc12eee8e88b3ad3878e089bd07dd803256358ca71951cece61d65e62b3aa9",

	"6abe395062e48c5a4ff278c5aedfdca9a80ebe474ea5eb88849468802a58b83b",
	"b49af1e1ec15880fb7c5a0e5f97538a86130058f58758af5fb6d0272bf8f0237",
	"05145ccd3dbe28e76dfb7b48072c82a379e36fef1720d7343d257f488eb7a50e",
	"b355f9c90587debc900a7498491736785ec79c97de7b4b8ddcc3f9cfc8cc3f34",
	"4793c316b9ec1fc75fd9d83c9a050ace3b79940d2622208957c3ad8480f006e9",

	"6446de55796eb238e30fadff35977e2d62de45ce5a27c794017ed9790c869101",
	"2a0cdf633153be7cda181aa8e9967c92ce13212a7f13c337e25661fbc971c658",
	"82210570ba2a9783aa80ede04921e45c9c03c59076e8e36a28b735fcaf2dc3a0",
	"1097272b8bd51660c911f48e293198ef7b1dd83804d80f8728d83f1320b5400e",
	"01ad6b464607fe30fefb419c25709c386b30b58e79ba1075d7ba82f16d0baefc",

	"8ccc3f94c4c0f0fe6fee9b853a54907811a95f66696dc72843ebfc2ff8445536",
	"7dc8d90e4139704f345c6bd80d7e029af6e2c7208bf5d6a4b679a60da53ba87e",
	"0ac8906f35d3f43d973ebc85c51d2137f8e6c9271082d22f2f8183e0d97376ff",
	"154e473e1bbd2b3a4326602079aa69f066359ea2cb6a71455a8ff72da1f9f724",
	"c676c044aaf9dedb19b9b4113b41952234e9ba8d6d46e47295b4009a484b6b93",

	"50ddc9d34d0e9cbb63f877ca2724a29a02a5e5aa74eab98065a379c29f319d1c",
	"e5fa050131dfa6d36627441b248e3bce51553041cdb1292d4a6c1b08890c1313",
	"3fb891468269d14360b875a4f80071474e66cb8069f8086f15931ea69c943acc",
	"4fc6ef3f31cd4ab2cf4ba4f9ad9cbdf27e3c7819ff3d6556b1d3746dabfd651c",
	"4f6f90ec5f3634d888a5f0a395bb50924cde20baddb25eaf8c86461221912cb5",

	"8c707a5ca1995b331b83ef6fc2cf9d11106ed16da7b5283004cc76d4af708215",
	"2a92fc430bca0b9cc36f89dd9832e68a947723fc5839b117b8bfc47b12029e4b",
	"ad40abf4e50de087d601bc5ca8f62dbe8809f172fcdcbf074f1aa9a3ac86d73a",
	"008930651ab148f1aad3b9432a2258d15c3216bde9931ef1bfb1a06b29202007",
	"8bb1833a245779a2ff346bc231c6924d2b4c5a991336b5997de85c694153c518",

	"87553a36be57779d14f14f7a3e4112e1ceb051fe6a849f003f6a2bb9ac266e39",
	"7c2b52951827b02e740edf0ce42cc98a6c2d6422f1ccd2d7a873daa47533dd4b",
	"32213ceb8b8d81b101a004bf12ca17704a77dd7135e383769904425a10fd4b9b",
	"c6ea83ef596207d6493e07158da61d1e5ff5e323d00436e3d7c874fdd167572c",
	"a83506244231388ae7a981fbe8fc816d7ea350e3a5d5d52492ad03d0fbc911ac",
}

// KAT do255s signature.
// Each group of five values is:
//   private key
//   public key
//   seed (can be empty!)
//   data (SHA3-256 of "sample X" with X = 0, 1,...)
//   signature
var kat_DO255S_SIGN = []string{
	"e7c1f12f0f7000d7f67a5a5c8d6a14700fba7a69d530c935c68105109ddce608",
	"e5a5789fe4447b6de68259cb8916a29d92b11bf817d51ba4423305c1ca22497d",
	"",
	"9eb7ccdd65cfb6e02f99210264c6424c911ab8890fcd93f064399d747b503ecf",
	"89d6cfd9a701d5a65b2f14570b340a21ba68d1d3c32e44a429b33d2db055910f0800d734bc10da80a0b2ab6e192d495eca1e71cc8ea53d8e70cbedf70a30643a",

	"115d54b74937d20f24816af4d1b35583f2c092285f59317b3b5c4ac4841ea113",
	"6bead75292150e0898e3404199f2d9490ac9ee2ff395d3a93458821bc29d2a1c",
	"b1",
	"45515ea2aec5e64eab4ca100c26b030447c07b66a9fb6f532cba12e1f62ae627",
	"59bb28b2be7735a883a2ce67b76352a9a993bd8dbf0739c4577b8ca6f6b7ae160dd09db54c27b3369405d6f5293628cb213c04fbc95550d7471c5465e4c1a239",

	"471329a46cd075adc0c4c36ac161a157e7900e7ce69457a58f9e2df4165cb401",
	"f306e28993bc5aa9ae3444bd59eb8ae3944c7b2b1393d53c182ab88566342210",
	"896d",
	"61954339a2d5ff28e0d496af0716d757891010625c8859cf2ffde8fc75f3e74d",
	"a71e987ee3a2e685376e2d91a8b169f6152b64ec59bc1a24ee070d9c5a06fd21db4173a6dd85818fe8d1f1c4136ef78e4e5112d8e4f8649bc1a1bda876df8d12",

	"cca6d9c557d0fec812da945f15258fd49288ac956ef6cfb46d5108ce14f2a604",
	"78e06a93e5d7e560f6a82695e7c5a3c74424f1ac0ea7cb9810f8d6aa7193ec7d",
	"356c39",
	"e1bc41167127f1944e47d6c3e9775ea31919040ede6f1843baf1a039a363467e",
	"57c144e06afe0e8434dd5619c6ad0edbc8117e42619267622a44df8efd8aea378d01662a382c49a6d6dafacb83762f6516f305150f1eb519740f758f2c604f12",

	"4f818f5503cac86c4988919dc6363e16646f677b35a8ffab5340d7144c301607",
	"7d528e8e6ba5fe7b942a31b881fe862febd67c53425a4eb1624bfadb70f1f430",
	"50c27940",
	"68b268348810d58120705fe0ac3faaa11218c81f6560541891772c58305d3f6e",
	"aa26f4b682f080f32cc265590c44cddede467d7454333dcf469687c629fb60668d6a8504e178e0492023996c05b4f8f320c0f2594f3fa76b6c21f4314c4c6425",

	"ec92eec04e4d608b7949b6673b223b0fada4b5cd0a45ed018d4d8341e7d73817",
	"ca8cfb6022395629da3be657808fd3985b34a5ecd20de61b023323b44e6eb711",
	"e47d5a9a3f",
	"91cc12bdabea62f2fad09995b2177f3d01011d2b52fa51219d961e8801cf9b84",
	"936599dbf96cdc7eadb145aa8e5c86c008d8810652cc91bfb26df3076b16e178328c28f89c4e4662be676d7994a02b96d9ae6c0f57e9702349c0c25955fe601e",

	"60f9d0bfbccf4b880b8c7961ef4c7f18c1424bfd38d68812ba288da371941d09",
	"903b6ce5c39c3a15f1f6a2782462cc39185192253fa1a8532e027e9a38fed13d",
	"e38710ceebd6",
	"0e298aef020cdd9cb9382d54f950d975b35f7807324d064c968cfb973f4d88a9",
	"28b268e0ce9ee196537ad9145ba51bb7911a21c383f698809b77f0a67fe355611559b223aaff4371d43d1c2f1eb15b4521b409062247a93b9e041089dfa21b1f",

	"38cab63ea60e7ccf213d04b3416c795e047f4897cc79968a3a28c2487c8dd51b",
	"00679269eebba60db4b8c2ef5dade2828d907ec582b8eefb13ea78b770402254",
	"e9ec0b55184b69",
	"bd6fa43ba1f3558c945ad97b86a16e46f18689d631832f36655808e0ae9625c4",
	"b250f5ee957d1fb1627e386947c8c6763797b3dfd818ec4601e169aff00db10ef88e829f7fc668c6f7d301b7c79f7d1feb45089ac4b4b7043185b2374a274815",

	"a0c852217d57f54af23b22c24663c08dfa39080a4ce479f15b29ca98aa1f7126",
	"7385259b9b2c90cb454e2a06ca0da0f7a2bd431a341d8df85592613f6519c06b",
	"89f04c834dc56e08",
	"15cad315726640f061a87262b030f8013d698829808ca191d29eab06e000d526",
	"3f699ff1c85c8355e95250a08cfa319ae38c5631a060878fd3feaae1a16c4d3a02d5f9c610306ecfc6be5692c01ae31dc915df2d864343d507093b0c396c3e29",

	"5f2aee1f839af4437708be00dc9fdd4b464f78cce503a2a46b7e49c7f8801e31",
	"cb6a952d21f8dac3e73719c5a2e25a5c0d25d296baa914a91017d4e2fd607543",
	"6ffcf67ae37c48bd44",
	"a3a01a7f31c626a828d91a2ba34453fac4864a1c2418f22d135ac28158e12ab3",
	"fc4e13e24ca421d18cd2abcac996c5583da63dab668862870e8338c984797d3f3f1e8ffabab56fe7b845d8f635d25f410105286244c288ab63ea73c2d75ba32e",

	"5180783172ddc9a101ea14d267606e7b086b9f199d285b9d963ad74e9c6a6129",
	"316e6c618476ff7f51315d9d4d7f2ec63099818b5d41fe64f109ad57365fc86b",
	"b5ec13448a6074acbe72",
	"3e2b0342ad12868adf498fc2a3c7bf168d115a3ca37fcb475541ead259f20c9a",
	"3fda8fcb7d32f98ecc7f7e1ed218bca9005774260e9db9ec7f26c0b9bef7dd0a1924bdca462df14986e740e8fb6fb498efb55765dc8de83eac6fb8cd9c8bed02",

	"6bfbb1a80603bb69eb67e30ec92a9643009223ae066317cd580763c74a5fee06",
	"e5625e553805421578ba2ee5399a5e6665ab343a67d0915cd4f789d22ee07652",
	"af57e5cd20151b84cb9b50",
	"8947bdb1b77d2117bc43d4933b89d835c28b0f5e228a2993f53711f0d6067499",
	"d7c5d21aa9fcd5632c5c5e79accdb1002e9930615f9d1f07c5f443f82ebed07a052060c8aa6b367bf9a4fda0b2cf2b488372ff57b9b4c6c48ade2d9dfbd9d024",

	"cebef0642b7dddf73345d784b85018b8c1f26b4fb9f1bfbb717bfc153e82c60f",
	"bda06c4aa5091c2bc2b7d81bf6962935f1e16fa4858bfe0bdd36ceaca8553200",
	"df6d2a11e996f8622c06c698",
	"ee4d9fd7516a121d065a71ba92bc70177ed7b12e1f62506d8f79127d790518c7",
	"ecc43c40ab39fbdaac1217d8407b540fcd41af0179ac06b595afaf1602ee1f564d9501f96e000ee249728df187dc8c3143e30f4d2967be37ebde283889f54939",

	"d163603878563d7a36f840d22c7a850363a6e8b094e471f60f7bfdc75da18e0a",
	"0721d84e87361db69031bf970e8bd5f3ae9d86c751b59417ee7139230f88da43",
	"fd6326d2da4c6683622d212e37",
	"1e713421d1a44b6ef1944e973d17764e44f580b91c53b9e11f4a1dc2783b435a",
	"0262368df64a673dcbdf5ba3791a1068e941e482d7d5aa06bdfa75847a4b5e2ed4b005878774c8884822bc8cd9f19d9f55a6aafb2f2b44899dd1c80e3e57bc0d",

	"93ae6d9673f5c48e26b37047d79c95bb1fe9aa1b496b5aaa1eb49eca880f2339",
	"7151af8a2e5cdaf205eb64172e88b23c257c73b0c1826a09ef5f02af37955118",
	"4f5b169cd6ae70f1490291708205",
	"8584de70ef2a343366c334bc11b8d9e837ba63833dbb619127075bdb906ac403",
	"41c78cf12f0c1fe16ab9d180d086d2faee58607fc891ab8132e641cefc9ea25e4e340928d90259419a08a9ebfa789ceff91bd86caf49d3875e83573a631fe226",

	"3b70f2cc6d753938d23ecdfab9621db34d1b606ddaafef479bdc0cf5fda83a18",
	"e73f4c27bfe24e2fda57ad76aab76554dc9f410589e78c93f4d152b5c4438807",
	"1ca32967015de8ec8276e1408ff3ce",
	"018571598ecb3dc0b96a693a85de4927aba6e64ba6be14ffc9e9ff65896bc3dd",
	"2e523cd538a1500265144b5d8c5d75e614045d398ffbaa44a9a65cee8f9b5717aa1e6e7ae16ec82682eddb547a4a2cb02feaafdecfa07d102b9802358c412f2d",

	"8becb40aff59d9d93289bb56b1957675794211bc3427882d1c54c7f3563d6c2d",
	"e29619933aaa702f0b733626eb7b7d3ae54047095d2448cf9a0281c1eb20114b",
	"38493f0d9d3f93d250a46ccfac0ad4f5",
	"c02b87d23b05e56f0f7b96500368a41c23e83c5b0603642e5de35f4cda0d9b89",
	"d31254216e4fd07da82d0c5ab5cc904dd475f44177e73d38e96551de6ec54c17c8b5a7239f05abea895e5831a58ad7c16246bdd6f40d6cba0880e18420e6612b",

	"25f0dfdeee9e6091cf0d2dc21c511c9a83cc341b62580e046aaaac8635aff502",
	"5b2244cfe0fdbc2dd9ca51c788b2ecf633c9877536e2ce2a9c444b58469a7b53",
	"a7e6bbd4302d191956d3e23a247b46b0ba",
	"4739c6afd6c5b3f1f58efe807bb068940bdc6725057661660442af88f9050aa8",
	"195773730c0136df3c4544437af5a8f10ec973e597990d2319b46eae58710a02c6c219c2afc30aaf96d769dbaf2b5157d4664299ea6e5b1533047d2b22e40911",

	"bd3c1a07a2961e85dd0ccca39045567a1f1f4c4e4f41e1190c8d5712be9a5b15",
	"b2faec833d71736c0fc8d28c5261bd4b61f29679d726fc17df3d68599e14435e",
	"c15641937d84e33443da70b5b5458a767097",
	"f8ec137d474d2fa4eebdd1f4acaa713743f0315f9480affad04af23ff7e4af4d",
	"a289f0ebeae6106d6e9d33721814c640a4cdaff4f856cdf582ba41819b958049a1eff69cdcbe022dfaa6889924687d5ed72e94982d0d2213f6a8d8e76d04931e",

	"56beec9f18c40a560e280e84d25480a68b6cabb1771f81828e3eac64d3d7530a",
	"723f50876ceccbd10f706ec389e34ecddc54552a1d6b5b2307879143dca1a365",
	"ace83bb731fdd197c1ac260a0b243057ca5f3c",
	"9403502de9faadba9fca6c0737f0f93058bcde07c7c0165714ace3084fb44086",
	"ebd4f2c77aa76448041f9c4e405fd4f1aef2fcc9a150a2257c60dd9dd68761657e1f4e2b7e331bede740598c35247401b251412261d4144832eaf2be18e1061b",
}

// Hash-to-curve tests for Do255s
// For i = 0..99, hash-to-curve using as data the first i bytes
// of the sequence 00 01 02 03 .. 62  (raw data, no hash function)
var kat_DO255S_HASHTOCURVE = []string{
	"8c35143563bb29d47d0d6ec499f7a87c7d10d17884d238b36c853bb8c185fe60",
	"59576551095a30f97af32498b5a0e6c186d8ed6fac7b3e6def5065ad3d26646c",
	"6724b037c9c1c71c486ed00623188c3bec884d7f97c0c7d0c54332b173610d20",
	"1a7a33303a6a05050132197e22f4fedfa42c06ed337f83c06fc9218dc0039759",
	"e2826a696c1c9fdebbf40069cd33f1c5dc9537cc01d89286dba57b3b70533f06",
	"23269765cb7facd0de7c614984285154b6a01415ba6d98cc66a66ccfeb730a61",
	"af038217e410f5b9966fead7d3dbaf1884adc303d97563b1ee9716aa465f8901",
	"07a3041a40f33fd15cf5f88a56c54ff4ba8eb121ae8b1571e39a0c64c3fdc243",
	"65940de3733e4c9aecac4e108e0e45cbe94fded31acbcf167539079b5423b407",
	"60767c7eaaba817450aa0c414de0cab0d44bb93279743f571f801ef22d2a191c",
	"9ea34c6ab1af1ccf4bc9fe4a04f7866fadbd31c639faa6495bd451449d022d23",
	"ae727ca185765c1c4a360a4f1b83f5ab320bea3b535b32df79d59f080954ae72",
	"964f944c3464bdca56ea87ec98e6342df8b664a0d30ef5633b10bdf8cfbe363f",
	"d20863ea8cae7d03ac9fe747a8c041a7fe92c04311fead520677278190d79104",
	"e5e36632efb9872cf81bf6fae52068c813b1137f87979bae7b81092fbc952e6f",
	"c124f7e1cc16d942c9187a202016d1a27d957e9e0df9cd93cfc1df49ab811f13",
	"d911125a17a764a5c7011612f3b932215b52c9cd4ce34d3bf92ffd91c6296f41",
	"8e0bdaeb8f8604a1650fcf659eb3a387b61fb6e44138632fe8ad875c7d2e0d4b",
	"a0fc0dc322d579ba389f3a75d3ad7fd59e04304cd4126ad55c8e0c3dceba7f74",
	"7a012a1827936b5a710e3557b50ebebfaaf1e51198a4a144e611ed62cb0e3476",
	"345fc77f3816626db1796a39a2c82757d01fb930cf34f4a336a4cbd50ee3e706",
	"250dd149cc80248f890ca3a73cb98038faf71d1a46cfe5dfdc67866256305a40",
	"86a4760aaaf6f65f3eb4faf7ad8e8a5a29a50779b41c70f19afc1f2c56726272",
	"0d3e23a30aa6b37cc76badcb68e15c603c43a934be686779735d12014af2274f",
	"ee9f9d815ffa0ba67f2fc5a9e13b64b9a58fd5634c86f57936a26b8925915e29",
	"af948113d4226fafa1eb4e3cefbcc47c919904325f68ba2d20e1d1b7fd1e7015",
	"215bb4bcbfb8827aa7416c790ac5965c7b22ca5428a276b414a72b1d561fb80d",
	"b38f1f8f5de6b71732853f786e966486dbb0c5b3f6923f55b4b2ed390c56c518",
	"23794c432a0f61e7b6022ee213ecc72f2fa2f1851e0209e7b85250be111a5d3d",
	"460213c323a4c8f68f826c45e7d80bd26f467d3c35a3446fde031f46cb206216",
	"38e1488c19b78c4c8756bcf4eed42f8a887a7a166d432d1a3264c89f41644e01",
	"d989985ad0c6ba22ceaf73efee43a3585034fa82fe89c66531646b58c36cfc55",
	"5dc6676c53893b75172525e9a87d91baabd790c83ea9a9e1a1c7da67a4bffe29",
	"b388676f85d778ea7faa86d6b73d31d21d4f18bb8be31066b9fa9aa4b7818d72",
	"d14718fc239ed0eea42deb5e68be1ff253d375ab743e91e6076e0a7198355753",
	"c0b9115fff3c70266ea4f999c3cd22ce8789f777f2bf228d9797e2c384501250",
	"4beec4d5a7504f4dfbc96094e9b339276cc40343b7623d8799fef4f213aa3b27",
	"54946aff70e5b27dace1487098df4805bd00804322437fded07698f161c65b6d",
	"63a8d805f7006abcb1c92b7a21578c08ea2855e66324c3cba638d652c44d2e55",
	"32151b640ffeaa0411c2b9ec13174277abc0aaa38115b668bf4a75b932fc5e30",
	"5c57700824d40b0777645528b9a30beb3e483359917a2a659a5c77751d70325a",
	"22841f145dd9275bc0c0b05beb4d3d865412983db93b98e5895619c734002465",
	"d79cd79635edafa2a735e3c005efe6f767ec7244637c264db99e4103d364de64",
	"9231bf2482ced363717ff81b3d3c2e388bd43c7a6cc3adc305a132ae405e2c0a",
	"87bb320a6a669d77455e17c103883fee41a070cd4781e9e2ce22d11a2aed885e",
	"b8f329f2c7bf551948dfdfb8f3990da0be285694e42ccef73bcd6772f55a2803",
	"58a457c3610d720bfa80ff401bbf63bbf1e619196bcbf880280b85763401d479",
	"547ed55a6355a7f8563f11d4217d325d9b37d4380789484563f219d43a6af17b",
	"88dfc63b8fb76966fa0bbf0515cc90b4c9b82a60bc6fd5c4fd55623d2f81b17a",
	"412e9dfd55bda895af4f39da96407f06be635c17637e32b1e0d4fcebda0d255a",
	"3758ac7e0387ed2ca95b942d8ecf3ef6f36cadb2cd48c8cd6f5789cb91e7e72b",
	"d7aa8e7f91639e07614b1b7363e1ded71891f5ea741cd2f43aab0afa2260b65a",
	"37eaa8c86f93d20f95c45187b9606befe0567bc2ad4b3f568b2036d5165a8b6c",
	"d63c099ccb5ed3dcd7747da52f4aae3f75fa868327768483cd6d730a8ae2283e",
	"0a4150f14f2d042491c1df67b1e16b65a681d5fcce69049cd756cffff3698f18",
	"df25f9f2498b180f6e826fc6628112430cd6895d533edac1e58f0300b5ce9e77",
	"f04125d1e3f3f9d3a042cee2a8b58086f76f2ba2f262cfe3210d7f39ddf4483f",
	"0232b4fe7aaeffafe8e806f346d3d930bb3cfa5d43d5d85c1ec01eadc4f9e33d",
	"17c8657d17021ce73427b981a7ac83a149edae0a0c360f31ee4359ae9af7dc5d",
	"15bdf2e72c95d9d99eb6136c918c957c4373cf110633e06a4f8b1e270c0fad00",
	"493a5f2fb1f9e55b6fe76cfc7d0b6b2e76baa9ddcb3ae73e3a03b12b049eb83e",
	"79dd571998c4801ae39941a431e1243f9c02bb530291bb7ff0cabcc3988a6733",
	"02860af5337512aac3f99d8174dd226618d0635c77f1d0c227db4c3a8f08386c",
	"dab3b53ea1486faa3b9881afde91751d50708f8fce2751c3aca51c6e9ed13b44",
	"098e257d4575448f3ab9c334f567e5f8ab9bd9423ff548ad55d53cc78b9e6e46",
	"33868cd10db59c109b30d1f93a7a92b0abeb472b9cf1e8f859b04d849697e728",
	"03da6fe617e7071b43604887c685b2fdcca08dd456a6ca12acb31173702bb643",
	"b4f55d9e129835fab1d9dfd98e356756a5bcae6e978e828024c31ad38d92aa76",
	"8d417184564ed3f60070dfedbacd3ba62664546d53a7b575130b8951a0be5371",
	"dfb363b9c8f034831d0de31e1e2f5ce0a2867d7fde8076a76e1dba34b763053f",
	"fdb60f76c6601507395092af8f9f81ed0ec7e8d0383ba8778dec726b4fea4770",
	"95cf00eb6599914728598671b5c4a3ec247ce0eb0faa212311751e7f27e1aa42",
	"998efe9e82d9cb862324e6c97fd9c7176c4cf09510f78a50062491ffed7a6742",
	"13769fc61477769d5418014a8065173b3f89e804c4f0ca87b71ddb98c605ab1a",
	"0c28957cde7c0219f51cda1872e9e75243157723ea9a261ad6a25988ca80177d",
	"2608b260a1fda0af848408f49ada63415972d771038e532ff7811eb1913f3e4b",
	"dedad45da7a1421f5b1c3dd01bb81906d0a735233cc50d5622121f7f7d962e4c",
	"4b93bb568dd4e2fc1074054c67b82e6b2b67e5986c9b8fbc7b16536dddb60c72",
	"abc4afe954f3f17d9544465f86d02e17b8744ea2e8d84a6a1e02c1559d536a1d",
	"dce51bfc4a032d8849f91ab01fd25722f3cb11e1560fc4dbae6b5fc20ff24670",
	"dbb5b802adb973f25feaceb6ea5a7471ba14389acc6890d821a6e008eba83a20",
	"b17c1d1dc897189e03d2c54aa10acaa76eb8298d9b86b81224fdf969a571cf11",
	"b6b628500dce4a23fabe9a65e4a11d749c1f42f86cc5c9675ba036e9a831ba65",
	"71e5fa4d352e389a3ce2953c4ecd9b718af81150baa5c47c15c0c3164ff7b472",
	"6aae4cf5e9a91f0c78bd00b4a7afc5b50eb61ace9989e3a526a9b4370fc7442f",
	"6af3ae261d3d779c8ea9c92c73f0e51c7d80b8403cf27f506311f4a2cded876f",
	"d5c4a4e295622e36751c553a6e9ca78b56a9a672a525bc03875412af7f9c1658",
	"3c918a93c63911f754c4c553ba92086a8a4031968c80c41d2b23784b8c7a9673",
	"cb4372ffab23a8a130dc7ec042a47888c2642db74e31c4484f332005fb56fc4d",
	"67632c77e3fb561bb377c87123d30a3e67cb64382bef2dea898c3af419237250",
	"e692c9bf8381a9f14b7706c7b54fdf7199b2f92a2f7b79123cfc219643b75b17",
	"4577bb695fdef6ef95670a0b73981a9b34191a34d0817bf36acb9ab2cc675400",
	"41bcdc50b33fa715e357b49b1f8202008cf47ba9634c3089bae3602027bb9f77",
	"c52a328eb1512390c29342530ff8e26b00a2dc57b41b5b6a76837eb7effbd61b",
	"761d6ad42448abf97429f7f06ebf3752960a45bad8e63893eaca8d635ea7f16a",
	"014c4564543df3137cc3d6b4915f6694427b3ddb736d450950d82bb3dd224c1c",
	"4eae98d914d1407a9463f76bc44acb17f3debe57875d692a17ce87c547311260",
	"c9bf5cb469ba38e1cdedf51dd7b78ae95a387560a06b6cbd8649c54c96dd5868",
	"91f20a822a430faab66529e3ff7fa9b05b916950bfbc79f209fbfafdde1ec22e",
	"d8deb1cb4e5597e6f28c279e0db145c2d9241d54ea80795dfe6e5ee50d0dc429",
}
