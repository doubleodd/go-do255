package do255e

import (
	"testing"
	"bytes"
	"crypto"
	"encoding/hex"
	"golang.org/x/crypto/sha3"
)

func TestDo255eKeyGen(t *testing.T) {
	for i := 0; (2 * i) < len(kat_DO255E_KEYGEN); i ++ {
		rsk, _ := hex.DecodeString(kat_DO255E_KEYGEN[2 * i])
		rpk, _ := hex.DecodeString(kat_DO255E_KEYGEN[2 * i + 1])
		sh := sha3.NewShake256()
		var bb [1]byte
		bb[0] = byte(i)
		sh.Write(bb[:])
		sk, _ := Do255eGenerateKeyPair(sh)
		esk := sk.Encode(nil)
		epk := sk.Public().Encode(nil)
		if !bytes.Equal(esk, rsk) {
			t.Fatalf("Wrong private key generated:\nexp = %s\ngot = %s\n", hex.EncodeToString(rsk), hex.EncodeToString(esk))
		}
		if !bytes.Equal(epk, rpk) {
			t.Fatalf("Wrong public key generated:\nexp = %s\ngot = %s\n", hex.EncodeToString(rpk), hex.EncodeToString(epk))
		}
	}
}

func TestDo255eECDH(t *testing.T) {
	for i := 0; i < len(kat_DO255E_ECDH); i += 5 {
		rsk, _ := hex.DecodeString(kat_DO255E_ECDH[i])
		rppk1, _ := hex.DecodeString(kat_DO255E_ECDH[i + 1])
		rsec1, _ := hex.DecodeString(kat_DO255E_ECDH[i + 2])
		rppk2, _ := hex.DecodeString(kat_DO255E_ECDH[i + 3])
		rsec2, _ := hex.DecodeString(kat_DO255E_ECDH[i + 4])

		sk, _ := Do255eDecodePrivateKey(rsk)

		sec, ok := Do255eKeyExchange(sk, rppk1, len(rsec1))
		if ok != 1 {
			t.Fatalf("Test %d: ECDH failed\n", i)
		}
		if !bytes.Equal(sec, rsec1) {
			t.Fatalf("Test %d: wrong secret:\nexp = %s\ngot = %s\n", i, hex.EncodeToString(rsec1), hex.EncodeToString(sec))
		}

		sec, ok = Do255eKeyExchange(sk, rppk2, len(rsec2))
		if ok != 0 {
			t.Fatalf("Test %d: ECDH should have failed\n", i)
		}
		if !bytes.Equal(sec, rsec2) {
			t.Fatalf("Test %d: wrong secret:\nexp = %s\ngot = %s\n", i, hex.EncodeToString(rsec2), hex.EncodeToString(sec))
		}
	}
}

func TestDo255eSign(t *testing.T) {
	for i := 0; i < len(kat_DO255E_SIGN); i += 5 {
		rsk, _ := hex.DecodeString(kat_DO255E_SIGN[i])
		rpk, _ := hex.DecodeString(kat_DO255E_SIGN[i + 1])
		seed, _ := hex.DecodeString(kat_DO255E_SIGN[i + 2])
		data, _ := hex.DecodeString(kat_DO255E_SIGN[i + 3])
		rsig, _ := hex.DecodeString(kat_DO255E_SIGN[i + 4])

		sk, _ := Do255eDecodePrivateKey(rsk)
		pk := sk.Public()
		epub := pk.Encode(nil)
		if !bytes.Equal(epub, rpk) {
			t.Fatalf("Test %d: wrong public key:\nexp = %s\ngot = %s\n", i, hex.EncodeToString(rpk), hex.EncodeToString(epub))
		}
		sig, err := sk.signWithSeed(seed, data, crypto.Hash(crypto.SHA3_256))
		if err != nil {
			t.Fatal(err)
		}
		if !bytes.Equal(sig, rsig) {
			t.Fatalf("Test %d: wrong signature:\nexp = %s\ngot = %s\n", i, hex.EncodeToString(rsig), hex.EncodeToString(sig))
		}
		if !pk.VerifyVartime(data, crypto.Hash(crypto.SHA3_256), sig) {
			t.Fatalf("Test %d: signature was not verified\n", i)
		}
		data[0] ^= byte(0x01)
		if pk.VerifyVartime(data, crypto.Hash(crypto.SHA3_256), sig) {
			t.Fatalf("Test %d: signature should not have been accepted\n", i)
		}
	}
}

func TestDo255eHashToCurve(t *testing.T) {
	var src [100]byte
	for i := 0; i < len(src); i ++ {
		src[i] = byte(i)
	}
	for i := 0; i < len(kat_DO255E_HASHTOCURVE); i ++ {
		rp, _ := hex.DecodeString(kat_DO255E_HASHTOCURVE[i])

		P, err := Do255eHashToCurve(src[:i], crypto.Hash(0))
		if err != nil {
			t.Fatal(err)
		}
		ep := P.Encode(nil)
		if !bytes.Equal(ep, rp) {
			t.Fatalf("Test %d: wrong output:\nexp = %s\ngot = %s\n", i, hex.EncodeToString(rp), hex.EncodeToString(ep))
		}
	}
}

// Keygen tests.
// For i in 0..19, keygen with SHAKE256((byte)i) as source.
// Each group of two values is the private/public key pair.
var kat_DO255E_KEYGEN = []string {
	"938b4583a72eb5382f3a2fa2ce57c3a4e5de0bbf30042ef0a86e36f4b8600d14",
	"b7d9c6c6adaf587b03120202c168831bc23b2a67f66d15aa0ce1382baaf14d52",

	"4a50b29655af442c8499c037f18ce8c278153d5b748baf796190856803d9773a",
	"ff2ac7224924892e240c731ec2e48309015d811568c9973d35ecdbc894a64704",

	"642e9115343df132c945255f0ff3d6969a9b5b7d7cb4adb2ca59716b5eacf811",
	"7f98f2bbf09789958c3613236c91b71762eb003778add1885490ee94c20aed47",

	"db4252337900d8ab7f609d170135d459a6798945d5a574d4a9db7b623c754d07",
	"5c9faa85d638a92d9e5c12afa46d49c2420efaab23190241530094b8efe72806",

	"87f1eb67b2f70780ff554843c8bd2980540cf15ed1d23499d013359759ef5927",
	"017536300dc562e33776b4ae9ee43a5e120667e292852e3aa978ab34fcc7820d",

	"41bc5a124a6e723eb004fb536a17dd1a577816bd83143f2397703f794ba3e130",
	"24d5334513be93d7eeac84f5694e9c20659107c17fe2055280e09d4c8819387a",

	"02c20375cc557dcb57eb02dc25f7f2390926071c3f4223cc321ba4cd0aec6502",
	"18dd6b94a95c55d29204751031bb915b6c6adc8878aecc305757b51e81dd983a",

	"493b59ef92575b18a6ad3ee1dbf2114c4aaa2571ae69543fa6a7a837532d0632",
	"f65a28c4afba44303bd8f1325c61d456e2e1f32b1525d0ccafa43dc36d204a27",

	"a662b8f9275568027b9bd157b6708b73ba8ca34a127e1c9f5d71d9ecb3afd423",
	"1cbe4b02bb3acbbc20764101c452061591b80d52eb89301424332c8a39ba9314",

	"288f7a3125bd12be279cb827b897c255267f97e4f7913713a80cb2630b646935",
	"59300e36d3d7d5a435c79b8dad6a974bffbeb3c9bc3ed54270e612dc10972451",

	"200f6e952677c538c9d831e3aeca6fc257a5b711d99cda07ff14042c4d8b833a",
	"9c9728c88778a9b6586d6f7049453160467829e16bb5ce4a7f63fac47e6f7f1f",

	"a56bc5fdf870fa3b77b648eb5ed73a6f0173659eededed0b7e6f6ebb886d392d",
	"26c4a638f7591e1a405a205594ce888992e24fbf5d9d8e14ea485d99c1908028",

	"47a53550f794a851c0dd80a0901cccbe981e40b1c4d1d69210f9f802e85fda1f",
	"289d5098634f96fe4e8ee706c580937946706db1b231458d4929cab8a482bf0a",

	"41ae0bf1dd0839c48045d6352642bb3119d92cff32063a1d3985f140fa2cfb2f",
	"c0a812552fc0516a4a3f131ed076fc95b4d98267683aeeed8d93655211cd5246",

	"4cf1f2bc5c4181cd0665fdae60d6e144a97e77a291188897de766170d6131503",
	"277d8ee6a02bfbfc276889c11ed2f5421713d7e61dd5e4dcd7bd080cbabc046e",

	"aabb07488ff9edd05d6a603b7791b60a16d45093608f1badc0c9cc9a9154f215",
	"da6a979fc42038aa88d27daf4df743322c4ab176c33ef1b310f5cd69f7f83b3c",

	"8d3e0b22c9824647109c1000aef645d43d83b327ef8d86caab540ef295edb33e",
	"2b2c16261d10532a98d7f88d68d5984b47e787842f158c9b46878c1a64e0bb55",

	"cd82320c3e9d68b16d40a3aefda68027950f0333bd845b66933d0bfabbec842f",
	"1e11506f4a8caef900bee6d2d9c80488ea8addedb1bfd663784a18a34615af04",

	"d3e72a448061f8c22a68661eef211387cd2851ebab1dc1cf4bff878a13686133",
	"d4bff10c04cfaa62793adb12318c9630361b4ebc62c17a4586585925f5570d27",

	"9ca015753a43f52834bab8182c96edbd895070a9998371ad3bab311da54c9716",
	"86ebdf40ca5df688a5534bd88066995f67502f1136818c609e1f92fc810d2f03",
}

// ECDH tests.
// Each group of five values is:
//   private key
//   public peer point (valid)
//   secret from ECDH with valid peer point
//   public peer point (invalid)
//   secret from ECDH with invalid peer point
var kat_DO255E_ECDH = []string {
	"ef28a690f4129956e9309b080a4a9314a70f070bf23a4ac5a5c7ceccd79bf713",
	"1d80ce62a0a2b3916844eee076f0ede0f58c6b1569076c80d931f482af777023",
	"1958e2c1e90c16bd1ce032d65389acc03ca40e86d7cb7d2c3da4951d8bc1d053",
	"c72d892b575ba6bf2120d8d376db16a79c8bd835af80661bdcfd4b5149267907",
	"fac3236e3b3841f2f08274c58ecd704535a285ebbdd7767e1b45d33261083141",

	"c8e5bd9585757ca9e984c08b6d5f04bfeacca23ae70c08d6cf483566460fc22c",
	"b6544dcc56df2c151507957542bdbdd8cd89f905eeb7f586df21650bd3034928",
	"c00d4181e7f07693440b531c0c4c0321d11787155cb810955a07d7db6639dc6e",
	"efa30b7f745011a1c2179bdeb65bf676f6699ed7fac93753483f3a18a7b4e31c",
	"f8fbf93e12a1340a64e3540c9fd6868f9425c32e4d2dd8e05ed0befd643af586",

	"d65c50065aa45d6184712e758c95e7d73dca997dc5b670354e9be636bd31181a",
	"31bffbc837e9295be72eb55281c82a258663503b1846e8e65d492c6f78d33718",
	"4b220af3c0b0c53051fe3f392b7a750ca37bb193dbd8122922f8480cd10de520",
	"53b0e353877607a0c33d544da0cca0248fa932e9460e42734a25cfc404bd5364",
	"398c5dab9da224b7064be994198ad14b4b231fce7432fa92e301d9ceafa8ffd6",

	"52fc76c0f047480bfa05b3a5da31ab2c28828cb6b7465209b2635a9fd567b23e",
	"f6a806c9c087fd2b8af290f83446870447cdb1f9e702f8117da313ef96d97605",
	"76e190d84232eefcaf6140296b710c22d725176008f3aa7aadde7c54325bdc26",
	"8dde1bbcfc6a2be8665d07e992c387277638b86aab3f96cd7be78f6eb22da12e",
	"612d7131f7b769f918544cf187b95b30fb25366d4a3d03895e906319c171acbb",

	"4c0469f97b0245cfead8fbc104ca54d18a917010f50eee1a4fca31e6d0b44d11",
	"f4254ce377b6bfb57b6b78202d5cec1deb66b00ad7441c691ea5166156de7c7d",
	"7696af08c6d643d1e1473016a61d50edcdfa7d43cca6d8968a7b00b3a8f2e1ff",
	"d168edbebd43705c4d03cb3368d0e25aa333553da0637cf5ed7e6f74e6f23c0c",
	"b0dc53f8f55edd519f4106704e29c676df46f67d48039aa31debb30f0911a464",

	"61f3fa5e5c6aaa53815d2f4458bb55f9dc78dfa0b871bb507551538b7b7aa907",
	"80772b696144793e55dc706a007aff79c4df1718aafa8bc224ccb993a27d2a7a",
	"3a2d8c445b2c3905ab81524718801adb0a762e7c17a259427b367ddf92c3d4a0",
	"de029424e3c3f4fed8e42b36865a645895e2430373dfc5c309f55a130954a42a",
	"a6b8713d608f63f8afea100db16949071e5e257c4dbfa3ce9327285d12f2204d",

	"9754017a70bd45fbda023f0a315502d394a424e3191368228a6f2e8b62e15818",
	"8533475f7404f1fc9cb904c61768035293e3787308da15a601aaee3b60f8034e",
	"f260f1faba57ee8a8bac32a0595696eea9b9ab683c145f9274213d0717d4c108",
	"4f19f142b0fbd94563629227cd36f047ea7edbf973d540e778227966257c142b",
	"47560853d57536c2f910d26536d53e2a594432d02994c4a5ee4080273c0e7b21",

	"12604b60bb1bada85a247f47cbbf2a14647ab8828110353fee8180c7feb0f708",
	"222aaa94d01a6bbeca96eaa5af11b6e350e04a5590c7b2536606d6c363b4f41e",
	"77f5b1a5f608f96d952439feef5ee7547453e29f04499b123d3944d3e48439e1",
	"b79607b0cbeb197c8705e2999f255af712ebc583ce819f2bf0e40008f20eb23f",
	"32fe19e0ee4589f3d9fe0212c9a2ab3b8f61d1067867fb9cfb6b3caf457e12bf",

	"3cfd86fc7dbf092f33a0a3c92022684216c6d10576cd7b3f7f64dbf5d85a6726",
	"d4c1d69dd7868fc85a37716ef5621b6787a274180f27c9d6e7e3c08908b8d069",
	"274ca75b281d5fb6f3304fe716123dacf7222d7b9efe6453ac50e83ac145e9e0",
	"c6511b4cfbe214659a02642c1c0e7893ef73802b21ef39d10a0710c674a79e5d",
	"23f57d371414d13ff1a516fae7a9db71ea1633efd42c69d7a27f62c997b79803",

	"1db9a064623f90f985e3f66cf8ff46bfffdb64e2fb73c8dc31d62acd362df419",
	"d6ba5e02dff611438c8a82d01790f257dfa7dc0c576e8ddd27cb1e9075eae008",
	"d89bdfe6b78549e7abe8e94819ae2eb817cd57d3cf340a3ae962baf777745a66",
	"bb733ca5f060f156bc08ba9865adf28febc683f14146d91259327750bb49af62",
	"788ecb175be5a165bfef25a6fd296a059ccc432c354e55afbd92a261605c773a",

	"ca00d92e95336b0bff5db5cc624e6c58b0e259a8ec1b0f3e3df6b92b22751214",
	"cdc2f220bb4d0ee2839cda1cb2bd4ff3f8f3c0144e5bce7b040a543285016442",
	"5e6755dd5e3282729ab5255a9f244fb1716ee5f5ed86c3b0c65998fa36d6b770",
	"9ff0fc35d268faec8ac0facd3c8c07d35ed8e4015cc7a492e7035b1396d7d94b",
	"38eb314008e1514309fdd940880dbf14bab3dc6b45e6ee6ef72d5eea9cf1e288",

	"b56284ea283943c82b3326e7df3a7743b4cb5ffc8015465f3e5dfa14d1aa0627",
	"56ff5c7c341845844bac18776aad2eb36e76a2e740800ee5f9fa3e2189acd91c",
	"b9e5f0b180d56f6a92db793e0a3830cd9ea39f8cf8269f5c644ed47b22d61a3c",
	"d6f8a731ffd43a2da991fbf88b32cd7beeb77243d8e1d72dd966a17b21e5d657",
	"0620573ba4423ca1e6466d1dff02cccfd2895b89ff26a7426a1c903cb9970ae9",

	"ea394e65ffed2af6f374ee698cbed8fc13aab0af934a1b67b15ed7c6caf1a721",
	"e80856ed01be82403a378cf21f91eab1de8dea8b9fc2ed7da8916d2166add716",
	"3e98515fe823f348975cb5d3b58679d68efa0a3c063e5909b97b0ba4abdcf496",
	"373520a86245d80d6807cb1af60b912f1a4d3e277c7c05d60276484f76353c2d",
	"889ce022eebfd41a508e4acf21346698f35bfba35d5d284e00467d6610e586dc",

	"395446b0114c7c2f5fdf9c84b445738b4b6af5b421610a6234f151f58999aa16",
	"efb29c8aaa0701a1c71ec9077571bb6d97a21c8dbb580714d655c3aa50943b72",
	"5473acad9ee583c23912093e553db4a31b45a539333825bb81b878d6844b5a56",
	"0b49ed1ee6809c76e3b342fd54ee375e1a54cf297d179d590dc6927ce31f5c67",
	"caceca76026bd4f8553b261b2eb7e40f96785de03df5b3a263b152d7894b590d",

	"093b4502c12f43f1d68888211a083efc7e551146f7385fe0e0203c3a87b6f902",
	"2204f8dee58e75732662dc0fd8ae5c9aacd9c288e8520431ff34bfd229a0b856",
	"681eab3e0f73552bbcffe9e8acb22b8446e65447818be1c022a0e9d7f719e16b",
	"2461e08ebafc979aca3af695553fb1f510bc96bbcca1c409226ee642a301c112",
	"065e2afb921b257909e17cf7a9df7ab803a491d80315688aa94ef3b2d8e9fbaf",

	"296e9c430cf963e46fc2de1e48709a9f535e7e54184741598689b082f2fb712f",
	"e09b38d065ee00bebed7613ebc77392b54d72c1c59ac13975561bf00ae62be5c",
	"812047baacb81e4840bdf7c5fec3c0107fb2879eba441fda416736258e95d2bb",
	"42548ab4526e5176aff6631263881f57144329b132622b2ed0ecc49d1491f36f",
	"51d7cc6309ce07eeb509bef43a290364f2a285c0e8b99792a8711c40211c5a77",

	"d550a88023a96a010b7f0b7a93be2fa67bdb72cc2ef8a1addd9c27d1464fd211",
	"ab4e38805ce3870142e9327fb63fa51ea3ed9110f028bb225f4806fe34e3b165",
	"47a4065fbd3beb39477675449febeb0833736dd0585957019446b6b6f4d38003",
	"ffbf316c28bc263ea9e7ec7f19ab66ffdac6e751f4b9d5b59173c953c2f06f3d",
	"b89d3a6a00953f1586e1176254adc1dd098070b8e05eb54e3ccfcf9cfa17c2d9",

	"738b0034bcb054c33bde8b804a14c55e9035bd917cf09085133788835cbbb326",
	"d1c9fc36def70c49c4388050dbf568319a873bd86a5e17697064999015ef6e21",
	"28ae15ca72336e4fcd1bd5ad809abd7d4a7fa7c6a94356df2a199308a0c59746",
	"6c299b2954771e58e67cb03585e481c00a5a76bad24dcd34cfe988df8361d675",
	"4299fb5f1f0e1b9f3b02b0ae44eeb9e62275210257bbef944cb2aad78973236c",

	"303b84fec8756acdfc55d108800ed5c78795a79bfc718fc47cee55b1b2d1741d",
	"92a8956299d060f6bb3a1ae456d4e27a16054130460efefe3827a624a83e9a05",
	"3d7d64b38c30375ccc7b7252b432766e84b738e6ee40b48d722a94c47d85c246",
	"b3587506e4711f45e1f9de2355e1dd4ca403d892907ca3505ac842049556dc2e",
	"09ec0b7c6fb336f28d8b983dcfce94d0043e8090f1b74660c0b657a873d694b9",

	"95c863ec9ebdf963536500f4610964b96941d25e47f3098f5c6fd82704836703",
	"8129d1f4e3d8e63bcca497ba0fa234b6d915fb052dd6d75f7febaa1b0f31e80b",
	"64af14c411a4b660b3572382496a1b762fe5db9f049614aecfb80325d4ab0405",
	"2cb6327b08618354aaef4ed354c90875569277ee6ef8cc5e3eeae8e2091e1f22",
	"b8366704521d00c86b2cceab783b73135ab1bd80aa568aebfd3f24f073d80a75",
}

// KAT do255e signature.
// Each group of five values is:
//   private key
//   public key
//   seed (can be empty!)
//   data (SHA3-256 of "sample X" with X = 0, 1,...)
//   signature
var kat_DO255E_SIGN = []string {
	"e7fefa881bd07b1c363b68a0f9e01ee04439f4aec941f402ae7be67993bcdf36",
	"4b383536c514fdd88fadd4699bb00f57cb16af174d086e65a291cb35957ee25f",
	"",
	"9eb7ccdd65cfb6e02f99210264c6424c911ab8890fcd93f064399d747b503ecf",
	"02df67f802428c4842a9337006f99bbe366e9d45330ebe59775fe233e24a1b471b450b81d63c76dfbf24b65dad69dcf19471a49346ae4e4239bc7846246bad29",

	"dd97542958b1929860ce00bbf16e70b96f585bdb40fe1c689c45089a25d2a33a",
	"2b2eaafa51faff7bb254388efe931a45efcccc9a18e0d2f22009ffac4a67dd33",
	"f6",
	"45515ea2aec5e64eab4ca100c26b030447c07b66a9fb6f532cba12e1f62ae627",
	"88bee51daef88d0122eefed288068e481d8600845232426c78833a2d3e2fb80d0d78997bedc3040667e65e37b6a73358a6b8be292c906dc924c0d87a1cf47c0c",

	"d621461ed0119fef78d82658d56db9a81e9de2a7dba43213941b150146cdd023",
	"82f078e1d7d4c27b87b44e94a5d65d10defa34b6c6187cdf27b6ba1cd0c8a416",
	"54e0",
	"61954339a2d5ff28e0d496af0716d757891010625c8859cf2ffde8fc75f3e74d",
	"aa362ed028a877b0e66c24ddfe04adff7168cafb6916e425f5997fe209de2e397eeed6838c1b2f37770612c2d816d1ee4b6dd72859131b92322ed6539403d035",

	"f1d2e620bdc765a7cca0da13c0181b15974d5ee3de8b66da9824b47706e8a90d",
	"245f4b6febec6d65a18dc721b92234b60f8cdd5cd6ec4bf379e2dbf1c4b3b960",
	"e2a81f",
	"e1bc41167127f1944e47d6c3e9775ea31919040ede6f1843baf1a039a363467e",
	"baa56a21d8d424da430e4b559faf3ce3d5c4a3500059ae91bd77b9c731b2a31657ca7fc36839b77045bedc022d17ebce315228dd7706225d3240cced47b0f21b",

	"7bf1ed60ed68b9ab68cd108f59ccf8c5244b3c67196ed682cdbdba199f2da826",
	"8d19cf9e1a466c45b25783295a5d7faa9c87aeebb66c3587b0a545c434c50062",
	"24e5f829",
	"68b268348810d58120705fe0ac3faaa11218c81f6560541891772c58305d3f6e",
	"f9dea4b04fdd1abcf5f363ac3baf8f9893c725ec7267257c7148fe6d9add5226d2ae40338d9b16826ce237b73f102271a5d3fc4c4d99b59824e4f90366ec1a38",

	"6a2c113c429adda15575b0df0e25423dcff7d999119e0259939fe13528976128",
	"242cc70b5bd1710e449864474cace3934da479971a462292ddfc86017533996c",
	"1d657c0787",
	"91cc12bdabea62f2fad09995b2177f3d01011d2b52fa51219d961e8801cf9b84",
	"afbf38a01391aabc062969fc90ae24844a05040804c254ab59c9e9ee4f27603a8702bfe8730c538ab1436e63b54dc73e1ea4826093a413b1940fd224de617507",

	"fdcb0a1f06aa24e5dfc01cd078e70509867d604275a1ac888cfccf45f4b4043e",
	"e84854f98bbed4bfc5cbb341ea31d74087818fb522828f0bc02300a9a3d84009",
	"5095bc20dffd",
	"0e298aef020cdd9cb9382d54f950d975b35f7807324d064c968cfb973f4d88a9",
	"5faef8cbc141c974bcb72a2174025730ba2cad3425e94302ab846c9b65ce935a6e8dfee1acfad9839506d6bbe7efc38b55e9bd8da0c591e9b206caaf4759f028",

	"e6f1ae77baf9b052eae31cae22ee3733fb976840f4b6ae4ad08188f00299f524",
	"2001c1321ef199a346ed03e826d93ea8d625a7aeb2e068abca08039409cd8c3b",
	"318a89d0101549",
	"bd6fa43ba1f3558c945ad97b86a16e46f18689d631832f36655808e0ae9625c4",
	"938102026e490a693d99f80c4385920006e6fb02a6fc751c3674fd739531e312aebf70726ee8454381d003310e7b3ea6010916283f7a54bf3ea8546558523709",

	"155e454cb96e895531ade93353db7b117fc99e6c4f5d3a7d66276e7f6230a42f",
	"1b758dfe2ac44b162db76c8763f0b942eb26dde011e6b69e5efdcbdbda5e9549",
	"b8000b24b6cad595",
	"15cad315726640f061a87262b030f8013d698829808ca191d29eab06e000d526",
	"c42e60dbaf1cc00342561dcbed70cc94bd80d37e261863721793682cab9e3502d94db97e792c2da4b0f3a386b8951b1f86dbda8371c1523dd67ca5c7ab5e101b",

	"4f73e0da62d285b6cb935de905cc86c5eb1172ce592b5a3f1b06329381db5e05",
	"42e38f43a66885ac8d5b55b096e1f2fbdac68c0cd734c95643cbbb1fc00a2e3c",
	"c37daa05a878983373",
	"a3a01a7f31c626a828d91a2ba34453fac4864a1c2418f22d135ac28158e12ab3",
	"75a0ae260f2fa0a64cd558a4adc7d3df092880201435d0181655453d3f6f715a57f9814be5265f9e087d47eef3b6cbe793cea5d090704161c5286df0cbec2e19",

	"ca209856bb248fccd018843b0b10e9fe1cb294a9213d78254a86a23ee5a79106",
	"7f8cb0ca92e9f8d0f1c9630833e6e28cfda0cb97d4728b1d28009abab545c234",
	"8b2bf5bec449e73da381",
	"3e2b0342ad12868adf498fc2a3c7bf168d115a3ca37fcb475541ead259f20c9a",
	"1699138979a0d5900446a16b31d7c3e30d438fbf482a6b026191f1fe11c37a7deb4033c7581705572a48b170d4e8c9ebbd3883f62f5bc5028bbc8b479e93501e",

	"9c5511323d7c143272ad5bbffb91a6af2f2be9a9d7a72643df3a7a790c944724",
	"6d76fe597859b316bec4f4c6a10403d84b8fd8797106ce8853a15e7a78318129",
	"4f3f552712d3c7ff7bb212",
	"8947bdb1b77d2117bc43d4933b89d835c28b0f5e228a2993f53711f0d6067499",
	"17330ef2c47365191905fa1ad9343b289340d62c44c94de0e1070dfc406fc335f12e800f4dc2600f18c61d9fa5cdb49f9af34a472d61720d346d402d9f2c6314",

	"4760c2b72a73b22cae763ce3903369fca15ab3fc3394aca4955e071213313820",
	"13d8e61e4a811bed22aec12fc4eb5176e05257c9e0ca62a75dedeb31b7d4832d",
	"867d02c2829dc1a05a553943",
	"ee4d9fd7516a121d065a71ba92bc70177ed7b12e1f62506d8f79127d790518c7",
	"a19560523ee01ad590ef3e6415713c3c0e7995cc2507de210e4ac4d20151a961a72c7ff988fe26ef7853780d6c87af552c22f61cfe0d083ce5d15a476484bd31",

	"6efd6cf3bc41af751a47a7a568c43fe05538c9bf4a4b56b92c87e384c369f701",
	"c790dfcf644d53bdb5c067df4a2d61e4d031d0422cdc6eae9e3a79572723a957",
	"9210040ba76b0d31aabbe1b79a",
	"1e713421d1a44b6ef1944e973d17764e44f580b91c53b9e11f4a1dc2783b435a",
	"6af33b5c8943e7e531a8fadb9a2a2da527f1219d6dcf9d56691dcccf505a4401f8e71e6710a5298005174c38e199782c7a26462219ab37fe0fb5919b1d5c8100",

	"9753da22261a95cdb29a35b2a53286ef3e091799fe88b80df7f081a05fbf8321",
	"cf8b7f0b66aad2ef6c53633c42f621406dd9c24ba97161a2efd451ed1422ae08",
	"4da18d848fa826de260ddc0c9cf6",
	"8584de70ef2a343366c334bc11b8d9e837ba63833dbb619127075bdb906ac403",
	"d9da40776f84ffbbdc0dd6dc765ffa3495e03502b5c628ee5a2f1d3ade7e2003cf43be376783a1fa6bf83644945f8036e08ab8c760fd78a456faa8794f77783a",

	"c87f825b563e86217e6eee2ed660982c7c9239c6cd90d011dc4a46fbba94e914",
	"bdd7e46cbba76e666be2a551564d449d3b3d10a480550c8a34c40ce696c82612",
	"338df4d100a8f105c7bc47ae7146cb",
	"018571598ecb3dc0b96a693a85de4927aba6e64ba6be14ffc9e9ff65896bc3dd",
	"79b67f4eef3383e68d53c63c76c185d87adec18f034ec476f416a12f5100a9050b059077f179902c0d8756e04e361f80a78b4596610f74d88fff7f7c58ccce0f",

	"d0cd7614980205ffdeb4cf87b81135d04a3975188ad1967b57f1a7b87d212a2a",
	"e7bedad9a67f17050b95d18978d1966cfc00300f39f4c9a706f7a1505e15ee34",
	"08495927e9336209338bf36dcf3aaa4e",
	"c02b87d23b05e56f0f7b96500368a41c23e83c5b0603642e5de35f4cda0d9b89",
	"d8effddf72c876db57beb1bc82b2e0feccd711bf5cc7384a92f2b9f2a987443744395abd62a55816333654cf1567a65d787da41444f80202d837dbce2c0d3805",

	"81db954da4ae7a5e0379a974094e64e6e23ff33e610de5e950d865f510adf325",
	"faf0d180629d98acbc28069304f932729689d72f72d4236b3fbbf189cf81141c",
	"fb52854932e67673d964ad8faad81bf1f9",
	"4739c6afd6c5b3f1f58efe807bb068940bdc6725057661660442af88f9050aa8",
	"6f2e0c0859922f76013ddd0830201723fb99cc58152edb121251e2a9c91c2b312bad2e2bbbe79ebb35b4b060843535b96cbe8a031a6eca6035e86706bebd1a16",

	"7f3365a6ac0fb684333b7d709b121369cd9a5cc6c191ee1df8cb40bda2635220",
	"9e07d0e40289c1c708f4d3f0bb3ee2fddafee94cf5bf3a441412edbc4a1e1c44",
	"da1eebfdebeb0b6e5c8999e3fbefd29d622a",
	"f8ec137d474d2fa4eebdd1f4acaa713743f0315f9480affad04af23ff7e4af4d",
	"cff66066d447a4d876590cfb0b02d1b553a7d942e6bbd65de3fdecf7ba6f2204861a5f4b112fc48cd0ff2f10ac987fbc2e2361c68da48f2cb3d4a05ec380561f",

	"3ea73a6a9e94de49026fa6c9385aed5a95b31643c0bc436e71ec15b55c7a6036",
	"78f4da98c85c33699114e047fcbb6d3cac9012bafe039e562356b1cae58bb53c",
	"e6efaa60b93f0c579dd6bd2f7bc6a60e4e9baa",
	"9403502de9faadba9fca6c0737f0f93058bcde07c7c0165714ace3084fb44086",
	"8dcb51309953408d891bd3a402dfb0dfced54130aabe5b490ad41614106d4c4aad6adb92ccc83a0fa95bdafd6084cf58b3d327525a80ca041a39e47bec759d01",
}

// Hash-to-curve tests for Do255e
// For i = 0..99, hash-to-curve using as data the first i bytes
// of the sequence 00 01 02 03 .. 62  (raw data, no hash function)
var kat_DO255E_HASHTOCURVE = []string {
	"861e72edc639eedb213402247d6407ae53560ef27e95c382f49f919bd2178a1d",
	"b72d63aaba58dc2452f076548f568a930650fda789ba831fe6240ad49e760335",
	"740f0b266692be55685a7ccd5128e831d6e12d23047e120dc80cc30393998226",
	"322a80507ea5ed3cd4c75679444de8467a2e2f80abb62793481dfcef5224a56c",
	"5a59995930f15ccb4c1a29755557a32ed272384cc0c99cdf455ad00a72afed1c",
	"57a2f7c94bdba928c49cad61eecf373454ea534fd8fcbb692a634b588f3ed547",
	"945c4fb41de6bd382a190b723bbea250836be9e916516aeed0198d640731ee44",
	"9bf508fe68ded333a854fc2c74a4d69e93df7ae49273e85ce4c9018e14e05c5a",
	"cd1da924eaa026f7a902ae14521174e307b66cd500a965445a07727656136c32",
	"7f3e88c73609d0aa799a197483de06d78f32d77f125dbb7626fef51b419fe072",
	"989d3c16763d1142928ff28234350dc31cdf34fbb411ef5272316f6d609ed007",
	"baed042923e5e0b1221e1c8a2e85819c00a821d6d31aa497f90cb688d4bf600b",
	"46dd3eee793887ec953fbc03299f29ada825bf1d3ded0c15866616d342a32545",
	"0e6e1e7722f1e56eefab4e29819045b0db5f88573fcb3fe2328e6bf8524e6214",
	"d34da5de99e0dcb27081bd490624bc24b2bc708458e9277648e3c10558b98862",
	"8b694aa9a5a1e9072f39d33d59f8fc4bcb23cae237b9c10dbf2c3b850efd364d",
	"b3823f5c9f0dbb47ae3e135bd9e3f1210600404c948b97388930ecb428191925",
	"2a7905eb92f67332ede28a9f9deb85155f3bf760d998c29860b07c69fc51f70c",
	"fe0d9083b7e90f4d17e978c2fb135fec262253b9d7d9be8a39ce70a17fe6812f",
	"0fdb2aae6916c8db6cf279a1293aafa49e44c8c029b7a83938c3cc0de2192c4d",
	"4474184a631e1875a82c8b56d954d684f5205b84aae1a6ea34387fd3fc618965",
	"34c3f83e195520a176e5b466c68526b732e86d4741253b83bf6a3fe5b1207000",
	"c5a7bf1c5c78df74d08f7755544f539db08a4712a749a296fc46f8ed68370636",
	"72577dc246ad6177c0ee965b9fce81d75d92858546204cc14f3122f30bb5a414",
	"63cfff6bfd336867f98f817089aad08a7e5b34ccdaae180939c1e200f736e077",
	"60c17f8e508606a337df2722aa23380ffb8e76d916b7b74bf29061777524b344",
	"1a83af7a615af8b93747a30bd37dec320d343d38bd7270bf499bc0c92c271325",
	"402529801d5d2702c44fcfd99cca07242574ab06465f795bca6ddca0c109784f",
	"0c2c2229b494070e7db740176437bb1213861eb05822b397c2ea7928972d7768",
	"c5b1e745e72bc8fdc521da65d00f1166b249c1921f2d1a295f5505d891ce7109",
	"f734e15a84cdef03602903ee596eb1e95d5a321866c77df49c7d4b1ae25a4e1e",
	"9a9f35fad601974fdb8a7a552aab3288f95eb207d20125f4289c3ffaea146739",
	"cfe2afee945e072176ae09903695920f9cb004df25158e663756d82ccc102a7b",
	"9fcb71820e2341ad3a1882d4857f496a93405920172514c89e0157ffbfb7513b",
	"348645699c431bd7199077c783932674cc2ddbc0a01c7a392558d6640f673216",
	"40d19d9df629e299e755be3ab4b44c54d4dd7f08e65288a2d9e1d26fba10da4b",
	"284bbeeb0cc4bd2d7208e758d902b8d71a01e9f72f3c783a7e8a458d52d78e7f",
	"cf46126f17b648ef1c0f1cb0b4a8fa22aabfbfb5a66008fbcc6719892f32e37c",
	"6bacd78ff0d6dd24df385b9c50ac8e9ad02a5a104d7c9ef74365de204d5e2963",
	"526c3e6a7923481480ce9254d34b3b9b174869ede1f7761cd794df4383d82f66",
	"5de4ef7c6c994d59c7d5af1d212836f7c7ebf4256585f3e47bca7399144cde29",
	"76f6811c3d1d3fc296dfd0f452117af0237cc2bacefee0f13eac2d04e0280c66",
	"1a51b5db42c78b7feb285212f7c2af8510cd400be3982c5f8aaf5a7b4911674f",
	"4c5f58d2b79df33e563fd8a42d62d86dfeb6bbceaf7c3db257be813cfe54f062",
	"6a2220c4a7507c1b89c95c7831382280aa9957b334af424d16f9bfb1ecf9932d",
	"83285ed4e62e64ad6cfda1484c042a352ebc4de94d5ae38f598a5dc049b97b59",
	"35acbee663ddf2202d8b1afed3f283f93c2201a908ebbdf3946d1c21e919ae4c",
	"4efe182b92402fa143ce11ae801c933f1cca888a431b811b6fe97c0e2a9cfb45",
	"4b8e7e48ce7a761befc3ba4df4b253e46c5134a6eddf344f3d44e571d9157a18",
	"fa639dfb30a6063c51925909d9b192283b90b6a78b0707824b5d7ccc3bebdf54",
	"e49bbecd48904995fc67602953da2f61c91b9ad490549ec94768b1249e214110",
	"946fb1f93254f175397e807c553c46f896d765cf6b12e0c80d7e2a4916a7b107",
	"b0936cd7e35593093db4954bffd6c477a2ffaec633430ff6f4e9ecc8b043683a",
	"9ac0ba7cc2542fd589cff9c339f137097f83f42f0f37f270b6cff6a9aaa41b58",
	"a88bc5dc7ea06c141933575c0226ceec5d1681513e5118dfceb090a6338f8e55",
	"2fa434804d5bd27cf6e9c2ccadb61b1162d3006e980fcae5a6af62e3d93b3e25",
	"19d3b3a009c0cbaff7431f8cf3ab4435822e953bc6b39b5082a0c6e9185a862d",
	"c5120a5f6916e859db7edb8c7bf4e0ee6d7718285e5bbb2b8bcb357310a8a246",
	"0a28e36e20cad5379cfe17898fb0191f581c42f7d3caf6c9b9e61bc1aebebb48",
	"3c94d00a09d2d6d171766785749e419486abfdf0a86bcc983c126419cf3a570a",
	"efa54d52539265c3b5eae3320487cae499b990c46ee458610b0e74a34ad5b106",
	"664efc21abfca2baa595a347c0556c8f9ce23de8529b778de3c8d13cdfe44a2b",
	"b8ee466d830b0c629f34ca7f4ceed98c92d8c76fa36a3961d81492b0c3892a3d",
	"bf78e67c6e22723ed6746d0baf083e40d759949c05a96ca2e3a065b32c882b16",
	"4eebf090d62e5eea40e3e452042c7f89e77a3e8eb77ff432f30957f62bb76009",
	"9b8425fc814c17e4102d01389c62f508963da6d98a8ca11d8ea6ddd008ec3e63",
	"bb1fce2d586d25c08496ac15e3fb737440b39583a25583b1683926d7db0cdb23",
	"18826a53178fe649cc877d8e5dcfaa844459b3dcc5760a6b9fa115a6cd3f3458",
	"8b05f1e1fd43b0be9344d5dfbbd41ed73094a070061b70d6b4de999ca871f510",
	"814003828a1f6e5daf54fa34710a935ed078b35ff4b16c16052791ff00b90d7d",
	"1b01be1f45997cbc2ad6ce5d5a85ddf79b899c338c65d21d8c1e4d00a4a1fe70",
	"653044b1a923fac6d5eedd8d86efac47923d7ae11a9615b380ce3e29f896b957",
	"44e0f3e7c29aa910c484aceed07433722de4c3eada4943b40616bb9485c6a107",
	"37550c2b6bf40c052a17c43e981fb0115197f3ce7402ef35f03abf68d5c55261",
	"ba8debe4587d2025a35741c5a89b2d2cee6df51c44b2e8b0b897ee8a981e5d6b",
	"e9f72566ca13f3e19504e205c199c05dc3da7228a08ec26d170abc25f9e47628",
	"891c557e298ff2fb581b2cec8a9eaca30e9b8502550b416ef6ff3c3194ccab02",
	"d356347493b35348983730c43211bfe5c68862e6779097e0ee6e72a2be3e8d72",
	"6942efa7a9c4682050257a9730fce592dc963aec071f5809165858709eaaa739",
	"4b05b689074073976ea72d8be80d7a4f6fc901285b168627cbe3b23c80db4729",
	"5df5049b00dcc0428fded1bd4f1ae66a7e95294d0d1dd19c02ad6b8b4f2f0f64",
	"2d897859114204fb9f8d975c6c084eeb24a7982ed49cc0fb66443b2113d81142",
	"c269f91836a3bc9cfbd199d3ea37cb0eca512cc3c05177e75885285485ba8504",
	"30a21295a0f3ba4bde9967f5493f73d2636736ff9d0857f31e60aebce5e18e6d",
	"12d0e154797f0ae938fd4538d9d2fff33a23e16f69d5b095217006d0e8d5c176",
	"1ab485cb1e96134090d5ee1885aaf5f7d90a5a96bf87225862b9249b4a1a2213",
	"aeaaab64314a6b48bdd173c801cb302025a25396116c633e79e165d1e9ee1e17",
	"cadc4f7262ed89b282a20ca38092504ccf1f8033f65f04fd8bacdd76f2eade52",
	"c54228e6f7fae77745b4ecfbfe323c546b95baa58da671d613c0bcc490292b40",
	"c68b7342e06739eb9d8632b7429342b9beb6a7660923aa6a0e3d992bce5f9a07",
	"7c36b5eb9f039ced61321e96d0ed446be221fefc5f701233366077abffb1743d",
	"3bed3db90e9aaf6adb728063e5518b723f1994a40262cb535bf16df102689f20",
	"9d57edbd744fcbef378eaedf6e51eae974a2e8bbc6b2b8f892938b5f354ab334",
	"519d2ba9129644043c610c6e45928fdb00e529ca1287d5471722f0dfd5a9dc60",
	"dbdcaabb3af4b7acbaf2f0893ee675c296e4ef7253fd80858c56da3890149e59",
	"3007e953e6f76886beafa8ee131d0c74c662461941c8cbcf1ce261c211f9df67",
	"da4c362b1def08eda514ef82e56bf4dbe7bd6af14cbd16414e8942080e900229",
	"bf21a32b133c49b0eb048ebb47c346e2cc4a1d52b4e92825414b2f6cf7185450",
	"8574291eb03ee42ac3212d697552bbe524ee954d6bed5b8844b4651f7929d515",
	"d84c40df970a0e8f7fb74571021823e38d4bcda3a381dff71572fe507ef32d09",
}
